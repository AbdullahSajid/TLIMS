!function(t){var e,n={isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},bind:t.proxy,each:function(e,n){t.each(e,function(t,e){return n(e,t)})},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,getUniqueId:(e=0,function(){return e++}),templatify:function(e){return t.isFunction(e)?e:function(){return String(e)}},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,h=e-(a-o);return n=this,i=arguments,h<=0?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,h)),s}},noop:function(){}},i="0.10.2",r=function(t){return{nonword:n,whitespace:e,obj:{nonword:i(n),whitespace:i(e)}};function e(t){return t.split(/\s+/)}function n(t){return t.split(/\W+/)}function i(t){return function(e){return function(n){return t(n[e])}}}}(),s=function(){function t(t){this.maxSize=t||100,this.size=0,this.hash={},this.list=new e}function e(){this.head=this.tail=null}return n.mixin(t.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key]),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new function(t,e){this.key=t,this.val=e,this.prev=this.next=null}(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];if(e)return this.list.moveToFront(e),e.val}}),n.mixin(e.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),t}(),o=function(){var t,e;try{(t=window.localStorage).setItem("~~~","!"),t.removeItem("~~~")}catch(e){t=null}function i(t){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}return e=t&&window.JSON?{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},get:function(e){return this.isExpired(e)&&this.remove(e),o(t.getItem(this._prefix(e)))},set:function(e,i,o){return n.isNumber(o)?t.setItem(this._ttlKey(e),s(r()+o)):t.removeItem(this._ttlKey(e)),t.setItem(this._prefix(e),s(i))},remove:function(e){return t.removeItem(this._ttlKey(e)),t.removeItem(this._prefix(e)),this},clear:function(){var e,n,i=[],r=t.length;for(e=0;e<r;e++)(n=t.key(e)).match(this.keyMatcher)&&i.push(n.replace(this.keyMatcher,""));for(e=i.length;e--;)this.remove(i[e]);return this},isExpired:function(e){var i=o(t.getItem(this._ttlKey(e)));return!!(n.isNumber(i)&&r()>i)}}:{get:n.noop,set:n.noop,remove:n.noop,clear:n.noop,isExpired:n.noop},n.mixin(i.prototype,e),i;function r(){return(new Date).getTime()}function s(t){return JSON.stringify(n.isUndefined(t)?null:t)}function o(t){return JSON.parse(t)}}(),u=function(){var e=0,i={},r=6,o=new s(10);function u(e){var i;e=e||{},this._send=e.transport?(i=e.transport,function(e,r){var s=t.Deferred();return i(e,r,function(t){n.defer(function(){s.resolve(t)})},function(t){n.defer(function(){s.reject(t)})}),s}):t.ajax,this._get=e.rateLimiter?e.rateLimiter(this._get):this._get}return u.setMaxPendingRequests=function(t){r=t},u.resetCache=function(){o=new s(10)},n.mixin(u.prototype,{_get:function(t,n,s){var u,a=this;function h(e){s&&s(null,e),o.set(t,e)}function c(){s&&s(!0)}(u=i[t])?u.done(h).fail(c):e<r?(e++,i[t]=this._send(t,n).done(h).fail(c).always(function(){e--,delete i[t],a.onDeckRequestArgs&&(a._get.apply(a,a.onDeckRequestArgs),a.onDeckRequestArgs=null)})):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(t,e,i){var r;return n.isFunction(e)&&(i=e,e={}),(r=o.get(t))?n.defer(function(){i&&i(null,r)}):this._get(t,e,i),!!r}}),u}(),a=function(){function e(e){(e=e||{}).datumTokenizer&&e.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=e.datumTokenizer,this.queryTokenizer=e.queryTokenizer,this.reset()}return n.mixin(e.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var e=this;t=n.isArray(t)?t:[t],n.each(t,function(t){var r,s;r=e.datums.push(t)-1,s=i(e.datumTokenizer(t)),n.each(s,function(t){var n,i,s;for(n=e.trie,i=t.split("");s=i.shift();)(n=n.children[s]||(n.children[s]={ids:[],children:{}})).ids.push(r)})})},get:function(t){var e,r,s=this;return e=i(this.queryTokenizer(t)),n.each(e,function(t){var e,n,i,o;if(r&&0===r.length)return!1;for(e=s.trie,n=t.split("");e&&(i=n.shift());)e=e.children[i];if(!e||0!==n.length)return r=[],!1;o=e.ids.slice(0),r=r?function(t,e){var n=0,i=0,r=[];t=t.sort(s),e=e.sort(s);for(;n<t.length&&i<e.length;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r;function s(t,e){return t-e}}(r,o):o}),r?n.map(function(t){for(var e={},n=[],i=0;i<t.length;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}(r),function(t){return s.datums[t]}):[]},reset:function(){this.datums=[],this.trie={ids:[],children:{}}},serialize:function(){return{datums:this.datums,trie:this.trie}}}),e;function i(t){return t=n.filter(t,function(t){return!!t}),t=n.map(t,function(t){return t.toLowerCase()})}}(),h=function(){return{local:function(t){return t.local||null},prefetch:function(e){var r,s;s={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(r=e.prefetch||null)&&(r=n.isString(r)?{url:r}:r,(r=n.mixin(s,r)).thumbprint=i+r.thumbprint,r.ajax.type=r.ajax.type||"GET",r.ajax.dataType=r.ajax.dataType||"json",!r.url&&t.error("prefetch requires url to be set"));return r},remote:function(e){var i,r;r={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(i=e.remote||null)&&(i=n.isString(i)?{url:i}:i,(i=n.mixin(r,i)).rateLimiter=/^throttle$/i.test(i.rateLimitBy)?(o=i.rateLimitWait,function(t){return n.throttle(t,o)}):(s=i.rateLimitWait,function(t){return n.debounce(t,s)}),i.ajax.type=i.ajax.type||"GET",i.ajax.dataType=i.ajax.dataType||"json",delete i.rateLimitBy,delete i.rateLimitWait,!i.url&&t.error("remote requires url to be set"));var s;var o;return i}}}();!function(e){var i,s;function c(e){e&&(e.local||e.prefetch||e.remote)||t.error("one of local, prefetch, or remote is required"),this.limit=e.limit||5,this.sorter=function(t){return n.isFunction(t)?function(e){return e.sort(t)}:function(t){return t}}(e.sorter),this.dupDetector=e.dupDetector||l,this.local=h.local(e),this.prefetch=h.prefetch(e),this.remote=h.remote(e),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new a({datumTokenizer:e.datumTokenizer,queryTokenizer:e.queryTokenizer}),this.storage=this.cacheKey?new o(this.cacheKey):null}return i=e.Bloodhound,s={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.Bloodhound=c,c.noConflict=function(){return e.Bloodhound=i,c},c.tokenizers=r,n.mixin(c.prototype,{_loadPrefetch:function(e){var n,i,r=this;return(n=this._readFromStorage(e.thumbprint))?(this.index.bootstrap(n),i=t.Deferred().resolve()):i=t.ajax(e.url,e.ajax).done(function(t){r.clear(),r.add(e.filter?e.filter(t):t),r._saveToStorage(r.index.serialize(),e.thumbprint,e.ttl)}),i},_getFromRemote:function(t,e){var n,i,r=this;return t=t||"",i=encodeURIComponent(t),n=this.remote.replace?this.remote.replace(this.remote.url,t):this.remote.url.replace(this.remote.wildcard,i),this.transport.get(n,this.remote.ajax,function(t,n){e(t?[]:r.remote.filter?r.remote.filter(n):n)})},_saveToStorage:function(t,e,n){this.storage&&(this.storage.set(s.data,t,n),this.storage.set(s.protocol,location.protocol,n),this.storage.set(s.thumbprint,e,n))},_readFromStorage:function(t){var e,n={};return this.storage&&(n.data=this.storage.get(s.data),n.protocol=this.storage.get(s.protocol),n.thumbprint=this.storage.get(s.thumbprint)),e=n.thumbprint!==t||n.protocol!==location.protocol,n.data&&!e?n.data:null},_initialize:function(){var e,i=this,r=this.local;return e=this.prefetch?this._loadPrefetch(this.prefetch):t.Deferred().resolve(),r&&e.done(function(){i.add(n.isFunction(r)?r():r)}),this.transport=this.remote?new u(this.remote):null,this.initPromise=e.promise()},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){this.index.add(t)},get:function(t,e){var i=this,r=[],s=!1;r=this.index.get(t),(r=this.sorter(r).slice(0,this.limit)).length<this.limit&&this.transport&&(s=this._getFromRemote(t,function(t){var s=r.slice(0);n.each(t,function(t){return!n.some(s,function(e){return i.dupDetector(t,e)})&&s.push(t),s.length<i.limit}),e&&e(i.sorter(s))})),s||(r.length>0||!this.transport)&&e&&e(r)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&u.resetCache()},ttAdapter:function(){return n.bind(this.get,this)}}),c;function l(){return!1}}(this);var c={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'},l={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};n.isMsie()&&n.mixin(l.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),n.isMsie()&&n.isMsie()<=7&&n.mixin(l.input,{marginTop:"-1px"});var d,p,f,g=function(){function e(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}return n.mixin(e.prototype,{trigger:function(t){var e=[].slice.call(arguments,1);this.$el.trigger("typeahead:"+t,e)}}),e}(),m=function(){var t=/\s+/,e=function(){var t;t=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)};return t}();return{onSync:function(t,e,i){return n.call(this,"sync",t,e,i)},onAsync:function(t,e,i){return n.call(this,"async",t,e,i)},off:function(e){var n;if(!this._callbacks)return this;e=e.split(t);for(;n=e.shift();)delete this._callbacks[n];return this},trigger:function(n){var r,s,o,u,a;if(!this._callbacks)return this;n=n.split(t),o=[].slice.call(arguments,1);for(;(r=n.shift())&&(s=this._callbacks[r]);)u=i(s.sync,this,[r].concat(o)),a=i(s.async,this,[r].concat(o)),u()&&e(a);return this}};function n(e,n,i,r){var s,o,u;if(!i)return this;for(n=n.split(t),i=r?(u=r,(o=i).bind?o.bind(u):function(){o.apply(u,[].slice.call(arguments,0))}):i,this._callbacks=this._callbacks||{};s=n.shift();)this._callbacks[s]=this._callbacks[s]||{sync:[],async:[]},this._callbacks[s][e].push(i);return this}function i(t,e,n){return function(){for(var i,r=0;!i&&r<t.length;r+=1)i=!1===t[r].apply(e,n);return!i}}}(),y=function(t){var e={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(i){var r;(i=n.mixin({},e,i)).node&&i.pattern&&(i.pattern=n.isArray(i.pattern)?i.pattern:[i.pattern],r=function(t,e,i){for(var r,s=[],o=0;o<t.length;o++)s.push(n.escapeRegExChars(t[o]));return r=i?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",e?new RegExp(r):new RegExp(r,"i")}(i.pattern,i.caseSensitive,i.wordsOnly),function t(e,n){var i;for(var r=0;r<e.childNodes.length;r++)3===(i=e.childNodes[r]).nodeType?r+=n(i)?1:0:t(i,n)}(i.node,function(e){var n,s;(n=r.exec(e.data))&&(wrapperNode=t.createElement(i.tagName),i.className&&(wrapperNode.className=i.className),(s=e.splitText(n.index)).splitText(n[0].length),wrapperNode.appendChild(s.cloneNode(!0)),e.parentNode.replaceChild(wrapperNode,s));return!!n}))}}(window.document),v=function(){var e;function i(i){var r,s,o,u,a,h=this;(i=i||{}).input||t.error("input is missing"),r=n.bind(this._onBlur,this),s=n.bind(this._onFocus,this),o=n.bind(this._onKeydown,this),u=n.bind(this._onInput,this),this.$hint=t(i.hint),this.$input=t(i.input).on("blur.tt",r).on("focus.tt",s).on("keydown.tt",o),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=n.noop),n.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){e[t.which||t.keyCode]||n.defer(n.bind(h._onInput,h,t))}):this.$input.on("input.tt",u),this.query=this.$input.val(),this.$overflowHelper=(a=this.$input,t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:a.css("font-family"),fontSize:a.css("font-size"),fontStyle:a.css("font-style"),fontVariant:a.css("font-variant"),fontWeight:a.css("font-weight"),wordSpacing:a.css("word-spacing"),letterSpacing:a.css("letter-spacing"),textIndent:a.css("text-indent"),textRendering:a.css("text-rendering"),textTransform:a.css("text-transform")}).insertAfter(a))}return e={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},i.normalizeQuery=function(t){return(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},n.mixin(i.prototype,m,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(t){var n=e[t.which||t.keyCode];this._managePreventDefault(n,t),n&&this._shouldTrigger(n,t)&&this.trigger(n+"Keyed",t)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(t,e){var n,i,s;switch(t){case"tab":i=this.getHint(),s=this.getInputValue(),n=i&&i!==s&&!r(e);break;case"up":case"down":n=!r(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!r(e);break;default:n=!0}return n},_checkInputValue:function(){var t,e,n,r,s;t=this.getInputValue(),r=t,s=this.query,n=!!(e=i.normalizeQuery(r)===i.normalizeQuery(s))&&this.query.length!==t.length,e?n&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=t)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(t){this.query=t},getInputValue:function(){return this.$input.val()},setInputValue:function(t,e){this.$input.val(t),e?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n;n=(t=this.getInputValue())!==(e=this.getHint())&&0===e.indexOf(t),!(""!==t&&n&&!this.hasOverflow())&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,e,i;return t=this.$input.val().length,e=this.$input[0].selectionStart,n.isNumber(e)?e===t:!document.selection||((i=document.selection.createRange()).moveStart("character",-t),t===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),i;function r(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}}(),_=function(){var e="ttDataset",i="ttValue",r="ttDatum";function s(e){var i;(e=e||{}).templates=e.templates||{},e.source||t.error("missing source"),e.name&&(i=e.name,!/^[_a-zA-Z0-9-]+$/.test(i))&&t.error("invalid dataset name: "+e.name),this.query=null,this.highlight=!!e.highlight,this.name=e.name||n.getUniqueId(),this.source=e.source,this.displayFn=function(t){return t=t||"value",n.isFunction(t)?t:function(e){return e[t]}}(e.display||e.displayKey),this.templates=function(t,e){return{empty:t.empty&&n.templatify(t.empty),header:t.header&&n.templatify(t.header),footer:t.footer&&n.templatify(t.footer),suggestion:t.suggestion||function(t){return"<p>"+e(t)+"</p>"}}}(e.templates,this.displayFn),this.$el=t(c.dataset.replace("%CLASS%",this.name))}return s.extractDatasetName=function(n){return t(n).data(e)},s.extractValue=function(e){return t(e).data(i)},s.extractDatum=function(e){return t(e).data(r)},n.mixin(s.prototype,m,{_render:function(s,o){if(this.$el){var u,a=this;this.$el.empty(),!(u=o&&o.length)&&this.templates.empty?this.$el.html(a.templates.empty({query:s,isEmpty:!0})).prepend(a.templates.header?h():null).append(a.templates.footer?d():null):u&&this.$el.html(function(){var u,h;return u=t(c.suggestions).css(l.suggestions),h=n.map(o,function(n){var s;return(s=t(c.suggestion).append(a.templates.suggestion(n)).data(e,a.name).data(i,a.displayFn(n)).data(r,n)).children().each(function(){t(this).css(l.suggestionChild)}),s}),u.append.apply(u,h),a.highlight&&y({node:u[0],pattern:s}),u}()).prepend(a.templates.header?h():null).append(a.templates.footer?d():null),this.trigger("rendered")}function h(){return a.templates.header({query:s,isEmpty:!u})}function d(){return a.templates.footer({query:s,isEmpty:!u})}},getRoot:function(){return this.$el},update:function(t){var e=this;this.query=t,this.canceled=!1,this.source(t,function(n){e.canceled||t!==e.query||e._render(t,n)})},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),s}(),w=function(){function e(e){var r,s,o,u=this;(e=e||{}).menu||t.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=n.map(e.datasets,i),r=n.bind(this._onSuggestionClick,this),s=n.bind(this._onSuggestionMouseEnter,this),o=n.bind(this._onSuggestionMouseLeave,this),this.$menu=t(e.menu).on("click.tt",".tt-suggestion",r).on("mouseenter.tt",".tt-suggestion",s).on("mouseleave.tt",".tt-suggestion",o),n.each(this.datasets,function(t){u.$menu.append(t.getRoot()),t.onSync("rendered",u._onRendered,u)})}return n.mixin(e.prototype,m,{_onSuggestionClick:function(e){this.trigger("suggestionClicked",t(e.currentTarget))},_onSuggestionMouseEnter:function(e){this._removeCursor(),this._setCursor(t(e.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){this.isEmpty=n.every(this.datasets,function(t){return t.isEmpty()}),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(t,e){t.first().addClass("tt-cursor"),!e&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(t){var e,n,i,r;this.isOpen&&(n=this._getCursor(),e=this._getSuggestions(),this._removeCursor(),-1!==(i=((i=e.index(n)+t)+1)%(e.length+1)-1)?(i<-1&&(i=e.length-1),this._setCursor(r=e.eq(i)),this._ensureVisible(r)):this.trigger("cursorRemoved"))},_ensureVisible:function(t){var e,n,i,r;n=(e=t.position().top)+t.outerHeight(!0),i=this.$menu.scrollTop(),r=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),e<0?this.$menu.scrollTop(i+e):r<n&&this.$menu.scrollTop(i+(n-r))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(t){this.$menu.css("ltr"===t?l.ltr:l.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(t){var e=null;return t.length&&(e={raw:_.extractDatum(t),value:_.extractValue(t),datasetName:_.extractDatasetName(t)}),e},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(t){n.each(this.datasets,function(e){e.update(t)})},empty:function(){n.each(this.datasets,function(t){t.clear()}),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){this.$menu.off(".tt"),this.$menu=null,n.each(this.datasets,function(t){t.destroy()})}}),e;function i(t){return new _(t)}}(),b=function(){var e="ttAttrs";function i(i){var r,s,o;(i=i||{}).input||t.error("missing input"),this.isActivated=!1,this.autoselect=!!i.autoselect,this.minLength=n.isNumber(i.minLength)?i.minLength:1,this.$node=function(n,i){var r,s,o,u;r=t(n),s=t(c.wrapper).css(l.wrapper),o=t(c.dropdown).css(l.dropdown),(u=r.clone().css(l.hint).css((a=r,{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}))).val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"}),r.data(e,{dir:r.attr("dir"),autocomplete:r.attr("autocomplete"),spellcheck:r.attr("spellcheck"),style:r.attr("style")}),r.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(i?l.input:l.inputWithNoHint);var a;try{!r.attr("dir")&&r.attr("dir","auto")}catch(t){}return r.wrap(s).parent().prepend(i?u:null).append(o)}(i.input,i.withHint),r=this.$node.find(".tt-dropdown-menu"),s=this.$node.find(".tt-input"),o=this.$node.find(".tt-hint"),s.on("blur.tt",function(t){var e,i,o;e=document.activeElement,i=r.is(e),o=r.has(e).length>0,n.isMsie()&&(i||o)&&(t.preventDefault(),t.stopImmediatePropagation(),n.defer(function(){s.focus()}))}),r.on("mousedown.tt",function(t){t.preventDefault()}),this.eventBus=i.eventBus||new g({el:s}),this.dropdown=new w({menu:r,datasets:i.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new v({input:s,hint:o}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}return n.mixin(i.prototype,{_onSuggestionClicked:function(t,e){var n;(n=this.dropdown.getDatumForSuggestion(e))&&this._select(n)},_onCursorMoved:function(){var t=this.dropdown.getDatumForCursor();this.input.setInputValue(t.value,!0),this.eventBus.trigger("cursorchanged",t.raw,t.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(t,e){var n,i;n=this.dropdown.getDatumForCursor(),i=this.dropdown.getDatumForTopSuggestion(),n?(this._select(n),e.preventDefault()):this.autoselect&&i&&(this._select(i),e.preventDefault())},_onTabKeyed:function(t,e){var n;(n=this.dropdown.getDatumForCursor())?(this._select(n),e.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(t,e){this.input.clearHintIfInvalid(),e.length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var t;this.dir!==(t=this.input.getLanguageDirection())&&(this.dir=t,this.$node.css("direction",t),this.dropdown.setLanguageDirection(t))},_updateHint:function(){var t,e,i,r,s;(t=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(e=this.input.getInputValue(),i=v.normalizeQuery(e),r=n.escapeRegExChars(i),(s=new RegExp("^(?:"+r+")(.+$)","i").exec(t.value))?this.input.setHint(e+s[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(t){var e,n,i,r;e=this.input.getHint(),n=this.input.getQuery(),i=t||this.input.isCursorAtEnd(),e&&n!==e&&i&&((r=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(r.value),this.eventBus.trigger("autocompleted",r.raw,r.datasetName))},_select:function(t){this.input.setQuery(t.value),this.input.setInputValue(t.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",t.raw,t.datasetName),this.dropdown.close(),n.defer(n.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(t){this.isActivated?this.input.setInputValue(t):(this.input.setQuery(t),this.input.setInputValue(t,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){var t,i;this.input.destroy(),this.dropdown.destroy(),t=this.$node,i=t.find(".tt-input"),n.each(i.data(e),function(t,e){n.isUndefined(t)?i.removeAttr(e):i.attr(e,t)}),i.detach().removeData(e).removeClass("tt-input").insertAfter(t),t.remove(),this.$node=null}}),i}();d=t.fn.typeahead,p="ttTypeahead",f={initialize:function(e,i){return i=n.isArray(i)?i:[].slice.call(arguments,1),e=e||{},this.each(function(){var r,s=t(this);n.each(i,function(t){t.highlight=!!e.highlight}),r=new b({input:s,eventBus:new g({el:s}),withHint:!!n.isUndefined(e.hint)||!!e.hint,minLength:e.minLength,autoselect:e.autoselect,datasets:i}),s.data(p,r)})},open:function(){return this.each(function(){var e,n=t(this);(e=n.data(p))&&e.open()})},close:function(){return this.each(function(){var e,n=t(this);(e=n.data(p))&&e.close()})},val:function(e){return arguments.length?this.each(function(){var n,i=t(this);(n=i.data(p))&&n.setVal(e)}):(n=this.first(),(i=n.data(p))&&(r=i.getVal()),r);var n,i,r},destroy:function(){return this.each(function(){var e,n=t(this);(e=n.data(p))&&(e.destroy(),n.removeData(p))})}},t.fn.typeahead=function(t){return f[t]?f[t].apply(this,[].slice.call(arguments,1)):f.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=d,this}}(window.jQuery);